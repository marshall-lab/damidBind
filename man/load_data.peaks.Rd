% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_dataframes.R
\name{load_data_peaks}
\alias{load_data_peaks}
\title{Load genome-wide binding data and associated peak files or GRanges objects}
\usage{
load_data_peaks(
  binding_profiles_path = NULL,
  peaks_path = NULL,
  binding_profiles = NULL,
  peaks = NULL,
  quantile_norm = FALSE,
  organism = "drosophila melanogaster",
  ensdb_genes = NULL,
  BPPARAM = BiocParallel::bpparam()
)
}
\arguments{
\item{binding_profiles_path}{Character vector. Path(s) to directories or file
globs containing log2 ratio binding tracks in bedGraph format. Wildcards ('*') supported.}

\item{peaks_path}{Character vector. Path(s) to directories or file globs containing
the peak calls in GFF or BED format.}

\item{binding_profiles}{List of GRanges objects with binding profiles, one per sample.}

\item{peaks}{List of GRanges objects representing peak regions.}

\item{quantile_norm}{Logical (default: FALSE). If TRUE, quantile-normalise the signal columns across all datasets.}

\item{organism}{Organism string (lower case) to obtain genome annotation from (if not providing a custom `ensdb_genes` object)  Defautls to "drosophila melanogaster".}

\item{ensdb_genes}{GRanges object: gene annotation. Automatically obtained from `organism` if NULL.}

\item{BPPARAM}{BiocParallel function (defaults to BiocParallel::bpparam())}
}
\value{
A list with components:
  \item{binding_profiles_data}{data.frame: Signal matrix for all regions, with columns chr, start, end, sample columns.}
  \item{peaks}{list(GRanges): All loaded peak regions from input files or directly supplied.}
  \item{pr}{GRanges: Reduced (union) peak regions across samples.}
  \item{occupancy}{data.frame: Binding values summarised over reduced peaks, with overlap annotations.}
  \item{test_category}{Character scalar; will be "bound".}
}
\description{
Reads DamID-seq log2 ratio binding data either from bedGraph files or
directly from a list of GRanges objects, and associated peak regions either
from GFF/bed files or from a list of GRanges objects.
This function is suitable for transcription factor binding analyses.
For peak discovery, use an external peak caller (e.g. 'find_peaks').
}
\details{
One of `binding_profiles_path` or `binding_profiles` must be provided.
Similarly, one of `peaks_path` or `peaks` must be provided.

When supplying GRanges lists, each GRanges should contain exactly one numeric
metadata column representing the binding signal, and all GRanges should be supplied
as a named list, with element names used as sample names.
}
\examples{
\dontrun{
# Using file paths:
res <- load_data_peaks(
  binding_profiles_path = "data/binding/",
  peaks_path = "data/peaks/",
  organism = "drosophila melanogaster")

# Using GRanges lists:
res <- load_data_peaks(
  binding_profiles = list(
    cond1_n1 = gr1,
    cond1_n2 = gr2,
    cond2_n1 = gr3,
    cond2_n2 = gr4),
  peaks = list(
    cond1_n1 = peaks_gr1,
    cond1_n2 = peaks_gr2,
    cond2_n1 = peaks_gr3,
    cond2_n2 = peaks_gr4),
  organism = "drosophila melanogaster")
}

}
