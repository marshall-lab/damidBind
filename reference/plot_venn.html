<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Draw proportional Venn diagrams for differential binding analysis — plot_venn • damidBind</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Draw proportional Venn diagrams for differential binding analysis — plot_venn"><meta name="description" content="Generates a two-set proportional Venn diagram summarising the results of the
differential binding analysis.  The set union represents significant binding
peaks that fail to show significant differences in occupancy; the exclusive
regions of each set represent regions with enriched differential binding in that condition.
Note that regions can be bound in both conditions, and still show differential occupancy.
For gene expression analysis, the set of analysed genes can optionally be
filtered by FDR such that the universe is restricted to only genes deemed
expressed, as is typically expected for DEG representations."><meta property="og:description" content="Generates a two-set proportional Venn diagram summarising the results of the
differential binding analysis.  The set union represents significant binding
peaks that fail to show significant differences in occupancy; the exclusive
regions of each set represent regions with enriched differential binding in that condition.
Note that regions can be bound in both conditions, and still show differential occupancy.
For gene expression analysis, the set of analysed genes can optionally be
filtered by FDR such that the universe is restricted to only genes deemed
expressed, as is typically expected for DEG representations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">damidBind</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marshall-lab/damidBind/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Draw proportional Venn diagrams for differential binding analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/marshall-lab/damidBind/blob/HEAD/R/plot_venn.R" class="external-link"><code>R/plot_venn.R</code></a></small>
      <div class="d-none name"><code>plot_venn.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates a two-set proportional Venn diagram summarising the results of the
differential binding analysis.  The set union represents significant binding
peaks that fail to show significant differences in occupancy; the exclusive
regions of each set represent regions with enriched differential binding in that condition.
Note that regions can be bound in both conditions, and still show differential occupancy.
For gene expression analysis, the set of analysed genes can optionally be
filtered by FDR such that the universe is restricted to only genes deemed
expressed, as is typically expected for DEG representations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_venn</span><span class="op">(</span></span>
<span>  <span class="va">diff_results</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="st">""</span>,</span>
<span>  set_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  font <span class="op">=</span> <span class="st">"sans"</span>,</span>
<span>  format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pdf"</span>, <span class="st">"svg"</span><span class="op">)</span>,</span>
<span>  region_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FFA500"</span>, <span class="st">"#2288DD"</span>, <span class="st">"#CCCCCC"</span><span class="op">)</span>,</span>
<span>  fdr_filter_threshold <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-diff-results">diff_results<a class="anchor" aria-label="anchor" href="#arg-diff-results"></a></dt>
<dd><p>A `DamIDResults` object, as returned by
`differential_binding()` or `differential_accessibility()`.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Plot title to use (default: generated from test condition context)</p></dd>


<dt id="arg-subtitle">subtitle<a class="anchor" aria-label="anchor" href="#arg-subtitle"></a></dt>
<dd><p>Subtitle to use (default is empty).</p></dd>


<dt id="arg-set-labels">set_labels<a class="anchor" aria-label="anchor" href="#arg-set-labels"></a></dt>
<dd><p>Character vector of length 2. Names for the two sets/circles (defaults to the analysis condition names).</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>Character. Path at which to save the diagram, if not NULL.</p></dd>


<dt id="arg-font">font<a class="anchor" aria-label="anchor" href="#arg-font"></a></dt>
<dd><p>Font name to use (default is "sans")</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>Character. Output plot format, "pdf" or "svg" (default "pdf").</p></dd>


<dt id="arg-region-colours">region_colours<a class="anchor" aria-label="anchor" href="#arg-region-colours"></a></dt>
<dd><p>Character vector of length 2 or 3. Fill colours for each set region (default: c("#FFA500", "#2288DD", "#CCCCCC")).</p></dd>


<dt id="arg-fdr-filter-threshold">fdr_filter_threshold<a class="anchor" aria-label="anchor" href="#arg-fdr-filter-threshold"></a></dt>
<dd><p>Numeric or NULL. If a value (e.g., 0.05) is provided, the universe of
loci considered for the Venn diagram will be restricted to those that pass this FDR threshold in
at least one sample.  Used for illustrating DEGs with RNA Pol TaDa. If NULL (default), all tested loci are used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function is called to generating a plot. It invisibly returns `NULL`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Helper function to create a sample DamIDResults object</span></span></span>
<span class="r-in"><span><span class="va">.generate_example_results</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">mock_genes_gr</span> <span class="op">&lt;-</span> <span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        seqnames <span class="op">=</span> <span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html" class="external-link">Rle</a></span><span class="op">(</span><span class="st">"2L"</span>, <span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">2000</span>, <span class="fl">3000</span>, <span class="fl">5000</span>, <span class="fl">6000</span>, <span class="fl">7000</span>, <span class="fl">8000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">2500</span>, <span class="fl">3500</span>, <span class="fl">5500</span>, <span class="fl">6500</span>, <span class="fl">7500</span>, <span class="fl">20000000</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>        gene_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FBgn001"</span>, <span class="st">"FBgn002"</span>, <span class="st">"FBgn003"</span>, <span class="st">"FBgn004"</span>, <span class="st">"FBgn005"</span>, <span class="st">"FBgn006"</span>, <span class="st">"FBgn007"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geneA"</span>, <span class="st">"geneB"</span>, <span class="st">"geneC"</span>, <span class="st">"geneD"</span>, <span class="st">"geneE"</span>, <span class="st">"geneF"</span>, <span class="st">"LargeTestGene"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"damidBind"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">loaded_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_data_peaks.html">load_data_peaks</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        binding_profiles_path <span class="op">=</span> <span class="va">data_dir</span>,</span></span>
<span class="r-in"><span>        peaks_path <span class="op">=</span> <span class="va">data_dir</span>,</span></span>
<span class="r-in"><span>        ensdb_genes <span class="op">=</span> <span class="va">mock_genes_gr</span>,</span></span>
<span class="r-in"><span>        quantile_norm <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">diff_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="differential_binding.html">differential_binding</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="va">loaded_data</span>,</span></span>
<span class="r-in"><span>        cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L4 Neurons"</span> <span class="op">=</span> <span class="st">"L4"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"L5 Neurons"</span> <span class="op">=</span> <span class="st">"L5"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">diff_results</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">diff_results</span> <span class="op">&lt;-</span> <span class="fu">.generate_example_results</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Locating binding profile files</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building binding profile dataframe from input files ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Loaded: Bsh_Dam_L4_r1-ext300-vs-Dam.kde-norm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Loaded: Bsh_Dam_L4_r2-ext300-vs-Dam.kde-norm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Loaded: Bsh_Dam_L5_r1-ext300-vs-Dam.kde-norm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Loaded: Bsh_Dam_L5_r2-ext300-vs-Dam.kde-norm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Locating peak files</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Applying quantile normalisation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating occupancy over peaks</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating average occupancy for 1208 regions...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating diagnostic plots...</span>
<span class="r-plt img"><img src="plot_venn-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_venn-2.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Condition display names were sanitized for internal data:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   'L4 Neurons' -&gt; 'L4.Neurons'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   'L5 Neurons' -&gt; 'L5.Neurons'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Applying filter: Loci must have occupancy &gt; 0 in at least 2 samples of at least one condition.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Filtered out 12 loci. 1196 loci remain for analysis.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Differential analysis setup:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Condition 1 Display Name: 'L4 Neurons' (Internal: 'L4.Neurons', Match Pattern: 'L4')</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Found 2 replicates:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Bsh_Dam_L4_r1-ext300-vs-Dam.kde-norm_qnorm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Bsh_Dam_L4_r2-ext300-vs-Dam.kde-norm_qnorm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Condition 2 Display Name: 'L5 Neurons' (Internal: 'L5.Neurons', Match Pattern: 'L5')</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Found 2 replicates:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Bsh_Dam_L5_r1-ext300-vs-Dam.kde-norm_qnorm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Bsh_Dam_L5_r2-ext300-vs-Dam.kde-norm_qnorm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> limma contrasts: L4.Neurons-L5.Neurons</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Applying eBayes moderation with `trend = TRUE, robust = TRUE`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering for positive enrichment (mean score &gt; 0 in the enriched condition).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 316 loci enriched in L4 Neurons</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Highest-ranked genes:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 166 loci enriched in L5 Neurons</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Highest-ranked genes:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene, LargeTestGene</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Displaying diagnostic plots...</span>
<span class="r-plt img"><img src="plot_venn-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the Venn diagram</span></span></span>
<span class="r-in"><span><span class="fu">plot_venn</span><span class="op">(</span><span class="va">diff_results</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_venn-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Owen Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

