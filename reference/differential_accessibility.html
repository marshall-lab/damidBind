<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Differential accessibility analysis for CATaDa (`NOISeq` based) — differential_accessibility • damidBind</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Differential accessibility analysis for CATaDa (`NOISeq` based) — differential_accessibility"><meta name="description" content="Setup and differential analysis for CATaDa chromatin accessibility experiments
using `NOISeq`. Accepts output from `load_data_peaks`, prepares a count matrix,
performs `NOISeq` analysis, and returns differentially-accessible loci."><meta property="og:description" content="Setup and differential analysis for CATaDa chromatin accessibility experiments
using `NOISeq`. Accepts output from `load_data_peaks`, prepares a count matrix,
performs `NOISeq` analysis, and returns differentially-accessible loci."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">damidBind</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/damidBind_vignette.html">damidBind</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marshall-lab/damidBind/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Differential accessibility analysis for CATaDa (`NOISeq` based)</h1>
      <small class="dont-index">Source: <a href="https://github.com/marshall-lab/damidBind/blob/HEAD/R/noiseq_functions.R" class="external-link"><code>R/noiseq_functions.R</code></a></small>
      <div class="d-none name"><code>differential_accessibility.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Setup and differential analysis for CATaDa chromatin accessibility experiments
using `NOISeq`. Accepts output from `load_data_peaks`, prepares a count matrix,
performs `NOISeq` analysis, and returns differentially-accessible loci.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">differential_accessibility</span><span class="op">(</span><span class="va">data_list</span>, <span class="va">cond</span>, regex <span class="op">=</span> <span class="cn">FALSE</span>, norm <span class="op">=</span> <span class="st">"n"</span>, q <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-list">data_list<a class="anchor" aria-label="anchor" href="#arg-data-list"></a></dt>
<dd><p>List. Output from load_data_peaks.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>A named or unnamed character vector of length two. The values are
strings or regular expressions used to identify samples for each condition.
If the vector is named, the names are used as user-friendly display names
for the conditions in plots and outputs. If unnamed, the match strings are
used as display names. The order determines the contrast, e.g., `cond[1]` vs `cond[2]`.</p></dd>


<dt id="arg-regex">regex<a class="anchor" aria-label="anchor" href="#arg-regex"></a></dt>
<dd><p>Logical. If `TRUE`, the strings in `cond` are treated as
regular expressions for matching sample names. If `FALSE` (the default),
fixed string matching is used.</p></dd>


<dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>Normalisation method passed to NOISeq.  Defaults to "n" (no normalisation), but "uqua"
(upper quantile) or "tmm" (trimmed mean of M) are options if needed</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Numeric. Q-value threshold for NOISeq significance (default 0.8).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A `DamIDResults` object containing the results. Access slots using accessors (e.g., `analysisTable(results)`). The object includes:</p>
<dl><dt>upCond1</dt>
<dd><p>data.frame of regions enriched in condition 1</p></dd>

  <dt>upCond2</dt>
<dd><p>data.frame of regions enriched in condition 2</p></dd>

  <dt>analysis</dt>
<dd><p>data.frame of full results for all tested regions</p></dd>

  <dt>cond</dt>
<dd><p>A named character vector mapping display names to internal condition names</p></dd>

  <dt>data</dt>
<dd><p>The original `data_list` input</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># NOTE: This example uses mock counts data, as the package's sample</span></span></span>
<span class="r-in"><span><span class="co"># data is in log2-ratio format.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a mock data_list with plausible count data</span></span></span>
<span class="r-in"><span><span class="va">mock_occupancy_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak1"</span>, <span class="st">"peak2"</span>, <span class="st">"peak3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gene_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID_A"</span>, <span class="st">"ID_B"</span>, <span class="st">"ID_C"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    GroupA_rep1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span>, GroupA_rep2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>, <span class="fl">25</span>, <span class="fl">45</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    GroupB_rep1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">200</span>, <span class="fl">55</span><span class="op">)</span>, GroupB_rep2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">220</span>, <span class="fl">60</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak1"</span>, <span class="st">"peak2"</span>, <span class="st">"peak3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mock_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    occupancy <span class="op">=</span> <span class="va">mock_occupancy_counts</span>,</span></span>
<span class="r-in"><span>    test_category <span class="op">=</span> <span class="st">"accessible"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run differential accessibility analysis</span></span></span>
<span class="r-in"><span><span class="va">diff_access_results</span> <span class="op">&lt;-</span> <span class="fu">differential_accessibility</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">mock_data_list</span>,</span></span>
<span class="r-in"><span>    cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group A"</span> <span class="op">=</span> <span class="st">"GroupA"</span>, <span class="st">"Group B"</span> <span class="op">=</span> <span class="st">"GroupB"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Condition display names were sanitized for internal data:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   'Group A' -&gt; 'Group.A'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   'Group B' -&gt; 'Group.B'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Differential analysis setup:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Condition 1 Display Name: 'Group A' (Internal: 'Group.A', Match Pattern: 'GroupA')</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Found 2 replicates:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     GroupA_rep1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     GroupA_rep2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Condition 2 Display Name: 'Group B' (Internal: 'Group.B', Match Pattern: 'GroupB')</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Found 2 replicates:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     GroupB_rep1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     GroupB_rep2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 loci enriched in Group A</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Highest-ranked genes:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GeneA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 loci enriched in Group B</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Highest-ranked genes:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GeneB</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the results summary</span></span></span>
<span class="r-in"><span><span class="va">diff_access_results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class 'DamIDResults'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Differentially accessible regions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparison: 'Group A' vs 'Group B'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - 1 regions enriched in Group A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - 1 regions enriched in Group B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - 3 total regions tested</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Owen Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

